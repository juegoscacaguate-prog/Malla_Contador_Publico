<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Malla Curricular Contador Público</title>
<style>
    body {
        font-family: 'Arial', sans-serif;
        background: #f5f5f5;
        margin: 0;
        padding: 20px;
    }
    h1 {
        text-align: center;
        color: #333;
    }
    .malla {
        display: flex;
        flex-wrap: nowrap;
        overflow-x: auto;
    }
    .semestre {
        min-width: 250px;
        margin: 0 10px;
        background: #fff;
        padding: 10px;
        border-radius: 10px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .semestre h2 {
        text-align: center;
        font-size: 1.2em;
        margin-bottom: 10px;
        color: #555;
    }
    .materia {
        padding: 8px;
        margin: 5px 0;
        border-radius: 5px;
        cursor: pointer;
        position: relative;
        transition: 0.3s;
    }
    .materia.aprobada {
        background: #a2d5ab;
        color: #fff;
        text-decoration: line-through;
    }
    .materia.bloqueada {
        background: #ddd;
        cursor: not-allowed;
        color: #888;
    }
    .tooltip {
        visibility: hidden;
        background-color: #333;
        color: #fff;
        text-align: left;
        border-radius: 5px;
        padding: 5px;
        position: absolute;
        z-index: 1;
        left: 105%;
        top: 50%;
        transform: translateY(-50%);
        white-space: pre-line;
        font-size: 0.8em;
        width: 200px;
    }
    .materia.bloqueada:hover .tooltip {
        visibility: visible;
    }
    .area-contabilidad { background: #ffe0e0; }
    .area-administracion { background: #e0f7ff; }
    .area-economia { background: #fff0e0; }
    .area-metodos { background: #e8ffe0; }
    .area-impuestos { background: #f5e0ff; }
    .area-gestion { background: #fff8e0; }
    .area-integradora { background: #e0fff5; }
</style>
</head>
<body>
<h1>Malla Curricular Contador Público - FCEA UDELAR</h1>
<div class="malla" id="malla"></div>

<script>
const materias = [
    // Primer semestre
    {id: 'conceptos', nombre:'Conceptos Contables', creditos:10, area:'contabilidad', requisitos:[]},
    {id: 'admin1', nombre:'Administración y Gestión de las Organizaciones I', creditos:10, area:'administracion', requisitos:[]},
    {id: 'micro', nombre:'Introducción a la Microeconomía', creditos:10, area:'economia', requisitos:[]},
    {id: 'calculo1', nombre:'Cálculo I', creditos:10, area:'metodos', requisitos:[]},
    // Segundo semestre
    {id: 'cont1', nombre:'Contabilidad General I', creditos:10, area:'contabilidad', requisitos:['conceptos']},
    {id: 'derecho1', nombre:'Derecho y Actividad Empresarial I', creditos:10, area:'impuestos', requisitos:[]},
    {id: 'macro', nombre:'Introducción a la Macroeconomía', creditos:10, area:'economia', requisitos:['micro']},
    // Tercer semestre
    {id: 'cont2', nombre:'Contabilidad General II', creditos:10, area:'contabilidad', requisitos:['cont1']},
    {id: 'derecho2', nombre:'Derecho y Actividad Empresarial II', creditos:5, area:'impuestos', requisitos:[]},
    {id: 'estadistica', nombre:'Introducción a la Estadística', creditos:10, area:'metodos', requisitos:['calculo1']},
    {id: 'procesos', nombre:'Procesos Contables', creditos:5, area:'contabilidad', requisitos:['admin1','conceptos']},
    // Cuarto semestre
    {id: 'cont3', nombre:'Contabilidad General III', creditos:10, area:'contabilidad', requisitos:['cont2']},
    {id: 'financiera', nombre:'Matemática Financiera', creditos:10, area:'metodos', requisitos:['calculo1','estadistica']},
    {id: 'derecho_digital', nombre:'Derecho Digital', creditos:5, area:'gestion', requisitos:['derecho1','derecho2']},
    {id: 'laboral', nombre:'Legislación Laboral y Seguridad Social', creditos:10, area:'impuestos', requisitos:['conceptos','derecho1']},
    // Quinto semestre
    {id: 'costos', nombre:'Modelos y Sistemas de Costos', creditos:10, area:'contabilidad', requisitos:['cont3']},
    {id: 'tributario', nombre:'Derecho Tributario', creditos:10, area:'impuestos', requisitos:['derecho1']},
    {id: 'social', nombre:'Contabilidad Social y Ambiental', creditos:5, area:'contabilidad', requisitos:['cont3']},
    {id: 'etica', nombre:'Ética y Ejercicio Profesional', creditos:5, area:'integradora', requisitos:['cont3','derecho1']},
    // Sexto semestre
    {id: 'sup1', nombre:'Contabilidad Superior I', creditos:10, area:'contabilidad', requisitos:['cont3']},
    {id: 'gerencial', nombre:'Contabilidad Gerencial', creditos:10, area:'gestion', requisitos:['costos','financiera']},
    {id: 'tributaria1', nombre:'Tributaria I', creditos:10, area:'impuestos', requisitos:['cont3','tributario']},
    {id: 'admin_fin', nombre:'Administración y planificación Financiera', creditos:5, area:'administracion', requisitos:['financiera','cont3','estadistica']},
    {id: 'control', nombre:'Control Interno', creditos:10, area:'gestion', requisitos:['cont3','procesos']},
    // Séptimo semestre
    {id: 'auditoria1', nombre:'Auditoría I', creditos:10, area:'contabilidad', requisitos:['derecho2','laboral','control','sup1','gerencial']},
    {id: 'tributaria2', nombre:'Tributaria II', creditos:10, area:'impuestos', requisitos:['tributaria1']},
    {id: 'finanzas', nombre:'Finanzas Corporativas', creditos:10, area:'administracion', requisitos:['costos','financiera','estadistica','admin1','macro']},
    // Octavo semestre
    {id: 'auditoria_int', nombre:'Auditoría Interna', creditos:5, area:'gestion', requisitos:['auditoria1']},
    {id: 'informes', nombre:'Informes Profesionales del Contador Público', creditos:10, area:'contabilidad', requisitos:['auditoria1']},
    {id: 'sig', nombre:'Contabilidad en sistemas Integrados de Gestión (SIG/ERP)', creditos:5, area:'gestion', requisitos:['cont3','control','sup1']},
    {id: 'macro_ap', nombre:'Principios de Análisis Macroeconómico Aplicado', creditos:10, area:'economia', requisitos:['macro']},
    {id: 'proyectos', nombre:'Proyectos de Inversión', creditos:5, area:'administracion', requisitos:[]},
    {id: 'bancaria', nombre:'Economía y Gestión Bancaria', creditos:10, area:'economia', requisitos:[]},
    {id: 'fintech', nombre:'Fintech', creditos:5, area:'gestion', requisitos:[]},
    {id: 'fin_pub', nombre:'Economía y Finanzas Públicas', creditos:10, area:'economia', requisitos:['micro']}
];

// Semestres para columnas
const semestres = [
    {id: 'sem1', nombre: '1° Semestre', materias:['conceptos','admin1','micro','calculo1']},
    {id: 'sem2', nombre: '2° Semestre', materias:['cont1','derecho1','macro']},
    {id: 'sem3', nombre: '3° Semestre', materias:['cont2','derecho2','estadistica','procesos']},
    {id: 'sem4', nombre: '4° Semestre', materias:['cont3','financiera','derecho_digital','laboral']},
    {id: 'sem5', nombre: '5° Semestre', materias:['costos','tributario','social','etica']},
    {id: 'sem6', nombre: '6° Semestre', materias:['sup1','gerencial','tributaria1','admin_fin','control']},
    {id: 'sem7', nombre: '7° Semestre', materias:['auditoria1','tributaria2','finanzas']},
    {id: 'sem8', nombre: '8° Semestre', materias:['auditoria_int','informes','sig','macro_ap','proyectos','bancaria','fintech','fin_pub']}
];

// Recuperar aprobadas del localStorage
let aprobadas = JSON.parse(localStorage.getItem('aprobadas') || '[]');

function actualizarMalla() {
    const contenedor = document.getElementById('malla');
    contenedor.innerHTML = '';

    semestres.forEach(sem => {
        const col = document.createElement('div');
        col.className = 'semestre';
        const title = document.createElement('h2');
        title.textContent = sem.nombre;
        col.appendChild(title);

        sem.materias.forEach(id => {
            const m = materias.find(x => x.id === id);
            const div = document.createElement('div');
            div.className = 'materia area-' + m.area;
            div.textContent = `${m.nombre} (${m.creditos} créditos)`;

            const pendientes = m.requisitos.filter(r => !aprobadas.includes(r));
            if(pendientes.length > 0) {
                div.classList.add('bloqueada');
                const tooltip = document.createElement('div');
                tooltip.className = 'tooltip';
                tooltip.textContent = 'Requiere:\n' + pendientes.map(rid => materias.find(x=>x.id===rid).nombre).join('\n');
                div.appendChild(tooltip);
            } else if(aprobadas.includes(m.id)) {
                div.classList.add('aprobada');
            } else {
                div.addEventListener('click', () => {
                    aprobadas.push(m.id);
                    localStorage.setItem('aprobadas', JSON.stringify(aprobadas));
                    actualizarMalla();
                });
            }

            col.appendChild(div);
        });

        contenedor.appendChild(col);
    });
}

// Inicializar
actualizarMalla();
</script>
</body>
</html>
<script>
const materias = [
    // ... misma definición de materias que antes ...
];

// Semestres para columnas
const semestres = [
    // ... misma definición de semestres que antes ...
];

// Recuperar aprobadas del localStorage
let aprobadas = JSON.parse(localStorage.getItem('aprobadas') || '[]');

function calcularCreditos() {
    return materias.filter(m => aprobadas.includes(m.id)).reduce((sum, m) => sum + m.creditos, 0);
}

function actualizarMalla() {
    const contenedor = document.getElementById('malla');
    contenedor.innerHTML = '';

    const totalCreditos = calcularCreditos();

    semestres.forEach(sem => {
        const col = document.createElement('div');
        col.className = 'semestre';
        const title = document.createElement('h2');
        title.textContent = sem.nombre;
        col.appendChild(title);

        sem.materias.forEach(id => {
            const m = materias.find(x => x.id === id);
            const div = document.createElement('div');
            div.className = 'materia area-' + m.area;
            div.textContent = `${m.nombre} (${m.creditos} créditos)`;

            // Verificar prerequisitos
            const pendientes = m.requisitos.filter(r => !aprobadas.includes(r));
            
            // Desbloqueo por créditos requeridos
            let creditosFaltantes = 0;
            if (m.requisitos.includes('120 créditos') && totalCreditos < 120) creditosFaltantes = 120 - totalCreditos;
            if (m.requisitos.includes('160 créditos') && totalCreditos < 160) creditosFaltantes = 160 - totalCreditos;
            if (m.requisitos.includes('180 créditos') && totalCreditos < 180) creditosFaltantes = 180 - totalCreditos;

            if(pendientes.length > 0 || creditosFaltantes > 0) {
                div.classList.add('bloqueada');
                const tooltip = document.createElement('div');
                tooltip.className = 'tooltip';
                let text = '';
                if(pendientes.length > 0){
                    text += 'Requiere materias:\n' + pendientes.map(rid => materias.find(x=>x.id===rid).nombre).join('\n') + '\n';
                }
                if(creditosFaltantes > 0){
                    text += `Faltan ${creditosFaltantes} créditos para desbloquear`;
                }
                tooltip.textContent = text.trim();
                div.appendChild(tooltip);
            } else if(aprobadas.includes(m.id)) {
                div.classList.add('aprobada');
            } else {
                div.addEventListener('click', () => {
                    aprobadas.push(m.id);
                    localStorage.setItem('aprobadas', JSON.stringify(aprobadas));
                    actualizarMalla();
                });
            }

            col.appendChild(div);
        });

        contenedor.appendChild(col);
    });
}

// Inicializar
actualizarMalla();
</script>
